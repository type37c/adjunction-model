# Step 1: ηの物理的意味の検証実験

**日付**: 2026-02-19  
**目的**: F/Gの再構成誤差ηが、物理的相互作用において意味のある信号を出すかを検証する  
**ステータス**: 実装中

## 1. 実験の背景

Phase 2.1の報酬設計を議論する前に、**ηが物理的相互作用で有益な情報を含むか**という根本的な問いに答える必要がある。この実験は、強化学習を使わない純粋な観察実験として設計される。

## 2. 実験設計

### 2.1. 環境構成

- **物理エンジン**: PyBullet
- **シーン**: テーブル（平面）上にオブジェクトを配置
- **オブジェクト**: 
  - カップ（円柱に近い形状、Phase 1の訓練分布に近い）
  - ボウル（球に近い形状、Phase 1の訓練分布に近い）
  - 箱（立方体、Phase 1の訓練分布内）
- **カメラ**: 固定視点からRGB-D画像を取得

### 2.2. 行動の種類

各オブジェクトに対して、以下の行動をスクリプトで実行する：

1. **静止観察**: オブジェクトを動かさず、複数フレーム観察
2. **視点変更**: カメラ位置を変えて観察（8方向）
3. **押す**: ロボットアームでオブジェクトを横から押す
4. **持ち上げる**: グリッパーで掴んで持ち上げる
5. **倒す**: オブジェクトを押して倒す
6. **回転させる**: オブジェクトを回転させる

### 2.3. データ収集

各行動について、以下を記録する：

- **タイムステップ**: t
- **行動の種類**: action_type
- **点群**: x_t（1024点）
- **再構成誤差**: η_t = ||G(F(x_t)) - x_t||²
- **部分再構成誤差**: η_part_t（オブジェクトの一部分のみの再構成誤差）
- **オブジェクト状態**: 位置、姿勢、速度（分析用）

### 2.4. 分析指標

以下の指標でηの振る舞いを評価する：

1. **行動種類別のη平均値と標準偏差**: 行動の種類によってηが系統的に変化するか
2. **時系列プロット**: 各行動シーケンスにおけるηの時間変化
3. **ηと姿勢の相関**: オブジェクトの姿勢変化とηの変化の相関
4. **ηの変動係数**: 同じ行動を繰り返したときのηの再現性

## 3. 予測されるシナリオ

### シナリオA：ηが行動の種類に応じて系統的に変化する

- 行動種類別のηに明確な差がある
- 時系列プロットで、行動の変化に応じてηが変化する
- **結論**: ηはアフォーダンスに関する有益な信号を含んでいる

### シナリオB：ηが行動に対してノイジーで無秩序に変化する

- 行動種類別のηに一貫したパターンがない
- 同じ行動を繰り返してもηの変化が毎回異なる
- **結論**: F/Gが物理的相互作用の結果を意味のある形で捉えられていない

### シナリオC：ηがほとんど変化しない

- オブジェクトが動いても倒れてもηがほぼ一定
- **結論**: F/Gの再構成能力が高すぎて、ηが差別的な信号にならない

## 4. 実装計画

### 4.1. ディレクトリ構造

```
experiments/step1_eta_validation/
├── EXPERIMENT_DESIGN.md  （本文書）
├── env/
│   ├── pybullet_simple_env.py  （PyBullet環境の最小実装）
│   └── point_cloud_utils.py  （深度画像→点群変換）
├── observe_eta.py  （観察実験のメインスクリプト）
├── analyze_results.py  （結果分析スクリプト）
├── data/  （収集データの保存先）
│   ├── cup/
│   ├── bowl/
│   └── box/
├── results/  （分析結果の保存先）
│   ├── plots/
│   └── RESULTS.md
└── checkpoints/  （Phase 1のチェックポイントをコピー）
```

### 4.2. 実装ステップ

1. **PyBullet環境の最小実装** (30分)
   - テーブルとオブジェクトの配置
   - カメラからRGB-D画像を取得
   - 深度画像を点群に変換

2. **F/G統合** (30分)
   - Phase 1のチェックポイント（`phase1_final.pt`）をロード
   - 点群をF/Gに通してηを計算する関数

3. **観察実験スクリプト** (1時間)
   - 各行動をスクリプトで実行
   - データを収集してCSVに保存

4. **実験実行** (30分)
   - 3つのオブジェクト × 6種類の行動 × 5回繰り返し = 90シーケンス

5. **結果分析と可視化** (1時間)
   - 行動種類別のη統計量を計算
   - 時系列プロットを作成
   - 相関分析

**総所要時間**: 約3-4時間

## 5. 期待される成果

- **定量的**: ηの行動種類別統計量、時系列データ、相関係数
- **定性的**: ηが物理的相互作用で意味のある信号を出すかの判断
- **次のステップへの示唆**: 
  - シナリオAなら → Step 2（随伴の検証）へ進む
  - シナリオB/Cなら → F/Gの改善が必要

## 6. 注意事項

- この実験は**強化学習を使わない**純粋な観察実験
- Agent Cは登場しない
- 報酬も定義しない
- 目的は「ηの振る舞いを理解すること」のみ
