# 物理的意味的随伴モデル：保留構造による知性の創発

## 1. はじめに：知性の本質は「保留構造」にある

本プロジェクトの核心的な洞察は、**知性の本体が「保留構造（Suspension Structure）」にある**という点です。これは、単に環境を効率的に予測・制御するだけでなく、予測が破綻した際にその「壊れた状態」を保持し、新しい解決策を創発的に再構成する能力を指します。

「物理的意味的随伴モデル」は、この保留構造を実装し、そのダイナミクスを検証するためのアーキテクチャです。世界（Shape）とエージェントの行動（Action）の間の構造的関係を記述する「随伴構造」は、知性が参照する安定した状態（川床）に過ぎません。真の知性は、この随伴が機能不全に陥った際（coherence breakdown）に創造探索モードへと移行し、新しい随伴を構築する「保留構造」の働きによって顕現します。

この文書は、この保留構造の理論を具体的な実装に結びつけ、その知的なダイナミクスを検証するための技術的設計を提示します。

## 2. アーキテクチャの全体像：保留構造を実現する2層モデル

保留構造を実現するため、モデルは以下の2つの層から構成されます。

-   **随伴層 (Adjoint Layer)**: 環境（Shape）とエージェントの行動（Action）の間の双方向写像 `F: Shape → Action` と `G: Action → Shape` を実装します。これは、エージェントが世界を「理解」し、「行動」する際の安定したインターフェースを提供します。ここでの `coherence signal` は、随伴の成立度合い（予測誤差）を示し、保留構造を起動させるトリガーとなります。この層から「差異への感受性」と「自己と非自己の区別」という保留構造の要件が生まれます。

-   **エージェント層 (Agent Layer, C)**: 随伴層を条件づけ、その動的な振る舞いを制御するエージェントの全内部状態を保持します。ここには「志向性（目的）」と「記憶」が格納され、`coherence breakdown` が発生した際に、新しい随伴を探索・構築する「保留空間」としての役割を担います。この層が、エージェントの文脈依存的で柔軟な振る舞いを可能にし、「時間的持続」という保留構造の要件を実現します。

この2つの層が動的なループを形成し、知性の本質である保留構造のダイナミクスを生成します。エージェント層Cが随伴層の振る舞いを決定し、その結果得られるcoherence signalがエージェント層Cを更新する、というサイクルを通じて、知性は環境に適応し、時には環境そのものを変革します。

## 3. 技術仕様：保留構造を実装する各コンポーネント

リサーチの結果を踏まえ、各理論的コンポーネントを以下の技術要素に対応させます。これが、理論と実装の具体的な「橋」となります。

| 理論コンポーネント | 実装方針 | ツール・先行研究 | 保留構造における役割 |
| :--- | :--- | :--- | :--- |
| **Shape圏** | 3Dオブジェクトの点群（Point Cloud） | ShapeNet, PartNet | 環境の物理的状態を表現。知性の「対象」となる世界。 |
| **Action圏** | 身体部位の相対的な姿勢とオブジェクト表面点との関係性の確率分布 | ZSP3A [1], ContactGrasp [2] | エージェントの行動可能性を表現。知性の「作用」する世界。 |
| **関手 F: Shape→Action** | グラフニューラルネットワーク（GNN）によるアフォーダンス予測モデル | PyTorch Geometric [3] | 形状から行動の可能性を推論。随伴層のエンコーダ。 |
| **関手 G: Action→Shape** | 条件付きGNNデコーダによる逆推論モデル | Andries et al. (2020) [7] | 特定の行動から、その行動を可能にする形状の機能的骨格を再構成。随伴層のデコーダ。 |
| **Coherence Signal (η)** | 再構成誤差 `distance(shape, G(F(shape)))` | Active Inference [4], 自己教師あり学習 | 随伴の成立度合いを示す。予測誤差として機能し、**保留構造を起動させるトリガー**となる（差異への感受性）。 |
| **エージェント状態 C** | DreamerV3のRSSM (Recurrent State-Space Model) の潜在状態 `(h, z)` | DreamerV3 [8] | 志向性（目的）と記憶を保持するエージェントの全内部状態。**保留構造の本体**であり、新しい随伴を探索する「保留空間」を含む。 |
| **記憶** | RSSMの確定的状態 `h` (GRUの隠れ状態) | DreamerV3 [8] | 過去の経験（coherence signalの履歴、行動結果）を圧縮・保持。保留構造の探索に利用。 |
| **志向性** | Active Inferenceにおける「好ましい観測の事前分布」 | Çatal et al. (2020) [9] | エージェントの目的や価値観。保留構造の探索方向を規定。 |
| **動的ループ** | `C(t)` → `F_C` → `η` → `C(t+1)` の更新サイクル | Active Inferenceのループ構造 | エージェントと環境の間の継続的な相互作用。保留構造の「時間的持続」を実現。 |
| **保留空間** | エージェント層C内の仮説生成モジュール (未実装) | (新規開発) | `coherence breakdown` 時に発動。既存の随伴に代わる新しい `F'` `G'` の候補をシミュレーション・生成する。 |

## 4. 2つの理論の統合：随伴モデルとActive Inferenceの深化

リサーチを通じて、本モデルとカール・フリストンが提唱する**Active Inference（能動的推論）**との間に強い対応関係があることが判明しました。`coherence signal (η)` はActive Inferenceにおける**予測誤差（自由エネルギー）**とほぼ同一視できます。これにより、本モデルは「圏論という代数的な言語でActive Inferenceを再定式化したもの」として位置づけることができます。

しかし、本モデルはActive Inferenceを単に再定式化するだけでなく、その概念を深化させます。Active Inferenceが予測誤差の「最小化」を原理とするのに対し、本モデルは**予測誤差の「破綻（coherence breakdown）」と、そこからの「再構成」**に知性の本質を見出します。これは、確率的な定式化が難しい「保留構造」や「創造性」といった概念を、より直接的に扱える可能性を示唆しています。

## 5. 保留構造による知性の創発を検証する実験デザイン

本モデルの真の動機は、単なる3D形状の再構成ではなく、**記号接地問題の解決、未知への般化、そして創造性の創発**にあります。実装の難易度を考慮しつつ、これらの理論的主張を検証するための段階的な実験設定を提案します。

### 設定A: 未知オブジェクトへの般化（ゼロショット・アフォーダンス）

-   **問い**: 学習データにないオブジェクトに対して、物理的な形状から機能を推論できるか？
-   **理論との接続**: これは `coherence breakdown` のテストです。未知オブジェクトは `distance(s, G(F(s)))` を増大させるはずです。しかし、もし随伴構造が本当に「機能的骨格」を抽出しているなら、形状の共通構造（「持ち手がある」「開口部がある」など）を通じて、カテゴリを超えた般化が起きるはずです。これは記号接地問題への間接的なアプローチでもあります。
-   **実験デザイン**: 
    1.  **学習フェーズ**: 日用品カテゴリA（例：カップ、ボウル、バッグ）のシンプルな形状と基本動作（押す、引く、持ち上げる）でFとGを訓練します。
    2.  **テストフェーズ**: 全く異なるカテゴリB（例：工具、医療器具）の未知の形状を提示します。
    3.  **評価**: `F(未知形状)` が出力する動作が、人間のアフォーダンス判断と一致するかを評価します。
-   **実装の工夫**: シミュレーション環境（例：PyBullet）で、シンプルな形状と基本動作に限定することで、実装難易度を抑えます。

### 設定B: 制約下での創造的問題解決

-   **問い**: エージェント状態Cの変化が、新しい行動の創発を引き起こすか？
-   **理論との接続**: これは「随伴がCによってパラメトライズされる」という核心的主張の検証です。`coherence breakdown` → 創造性、という理論の検証に直結します。特に、**保留構造が新しい随伴を探索・構築する能力**を検証します。
-   **実験デザイン**: 
    1.  **標準状態 `C_normal`**: シミュレーション環境で、エージェントが標準的な身体状態（例：両腕が使える）でスーツケースを運ぶタスクを学習させ、「片手で持つ」などの行動を選択させます。
    2.  **制約の追加 `C_injured`**: エージェント状態Cに制約（例：`right_arm: disabled`）を加え、同じタスクを実行させます。このとき、「転がす」などの代替行動が選択されるかを観察します。
    3.  **複合制約 `C_complex`**: さらに制約（例：`right_arm: disabled, noise_constraint: high`）を加え、`coherence breakdown` が起きる状況を作り出します。このとき、既存の動作プリミティブの新しい組み合わせ（例：「両膝で抱える」）が創発的に生成されるかを評価します。これは、**保留空間が新しい随伴を生成した証拠**となります。
-   **実装の工夫**: 制約の追加は、Cの表現（例：状態ベクトルの一部をマスクする、特定の値を固定する）や、シミュレーション環境の物理パラメータを変更することでシミュレートします。

### 設定C: 言語との接地（Symbol Grounding）

-   **問い**: 形状と動作の随伴から学んだ表現は、言語記述と整合するか？
-   **理論との接続**: これは記号接地問題への直接的なアプローチです。もし保留構造が「意味」を自ら生成しているなら、その表現空間は言語的な機能記述と構造的に対応するはずです。
-   **実験デザイン**: 
    1.  **学習フェーズ**: FとGで形状→動作の双方向推論を学習させます（言語入力なし）。
    2.  **言語記述の用意**: 別途、LLMが生成する機能記述（例：「液体を注げる」「重いものを運べる」）を用意します。
    3.  **アラインメント評価**: `G(F(shape))` が抽出した機能的骨格（再構成された形状特徴やアフォーダンス分布）を、LLMの記述とアラインメントできるかを評価します。例えば、アフォーダンス分布と言語埋め込みのコサイン類似度を測る、あるいは言語記述から形状を生成するモデルを別途訓練し、Gの出力と比較するなど。
-   **実装の工夫**: 言語記述と形状・動作表現のアラインメントには、CLIPのようなマルチモーダル埋め込みモデルの技術を応用できます。

## 6. 結論と今後の課題

本設計文書は、「知性の本体は保留構造にある」という根本的な洞察に基づき、物理的意味的随伴モデルの理論と実装の橋渡しを行いました。随伴構造は知性が世界を理解する際の「安定した器」であり、保留構造はその器が壊れた際に新しい器を創発的に構築する「ダイナミクス」です。

今後の課題は、この設計に基づきプロトタイプを実装し、提案された実験設定を通じて、保留構造による知性の創発を実証することです。特に、`coherence breakdown` の検出と、それに続く「保留空間」での新しい随伴の探索・構築メカニズムの実装が、本プロジェクトの成功の鍵となります。

## 7. 参考文献

[1] Kim, H., et al. (2024). *Zero-Shot Learning for the Primitives of 3D Affordance in General Objects*. arXiv:2401.12978.
[2] Sundermeyer, M., et al. (2021). *Contact-GraspNet: Efficient 6-DoF Grasp Generation in Cluttered Scenes*. arXiv:2103.14243.
[3] Fey, M., & Lenssen, J. E. (2019). *Fast Graph Representation Learning with PyTorch Geometric*. arXiv:1903.02428.
[4] Parr, T., Pezzulo, G., & Friston, K. J. (2022). *Active Inference: The Free Energy Principle in Mind, Brain, and Behavior*. MIT Press.
[5] Heins, C., et al. (2022). *pymdp: A Python library for active inference in discrete state spaces*. Journal of Open Source Software, 7(73), 4098.
[6] Graves, A., et al. (2014). *Neural Turing Machines*. arXiv:1410.5401.
[7] Andries, J., et al. (2020). *Automatic Generation of Object Shapes With Desired Affordances*. Frontiers in Neurorobotics, 14, 22.
[8] Hafner, D., et al. (2023). *Mastering Diverse Domains through World Models*. arXiv:2301.04105.
[9] Çatal, O., et al. (2020). *Learning Generative State Space Models for Active Inference*. Frontiers in Computational Neuroscience, 14, 574372.
