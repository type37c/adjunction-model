@startuml
!theme vibrant

left to right direction

package "Phase 1: Pre-training" {
  cloud "F (Encoder)" as F1
  cloud "G (Decoder)" as G1
  database "L_aff + L_recon" as Loss1

  F1 -> Loss1
  G1 -> Loss1
}

package "Phase 2: Slack Preservation" {
  cloud "F (Encoder)" as F2
  cloud "G (Decoder)" as G2
  agent "Agent C" as C2
  database "L_aff + L_kl + L_coherence" as Loss2

  F2 -> Loss2
  G2 -> Loss2
  C2 -> Loss2
}

package "Phase 3: Fine-tuning" {
  cloud "F (Encoder) [Frozen]" as F3
  cloud "G (Decoder) [Frozen]" as G3
  agent "Agent C" as C3
  database "L_task + L_kl" as Loss3

  C3 -> Loss3
}

Phase1 -> Phase2
Phase2 -> Phase3

@enduml
