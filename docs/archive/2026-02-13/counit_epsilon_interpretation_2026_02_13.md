# Counit ε の解釈

**作成日**: 2026-02-13  
**関連**: `docs/adjunction_slack_analysis_2026_02_13.md`

## 1. 圏論的定義

随伴 F ⊣ G において：

- **Unit η**: `Shape → G(F(Shape))`
- **Counit ε**: `F(G(Affordance)) → Affordance`

### 三角恒等式

随伴が成立するための条件：

```
F --F(η)--> F·G·F --ε·F--> F  (identity on F)
G --η·G--> G·F·G --G(ε)--> G  (identity on G)
```

これらが恒等射であることを要求する。

## 2. 現在の実装での計算

```python
# Step 1: Shape → Affordance (F)
affordances = F(shape)

# Step 2: Affordance → Shape (G)
reconstructed = G(affordances)

# Step 3: Shape → Affordance (F again)
affordances_reencoded = F(reconstructed)

# Counit ε: ||affordances - affordances_reencoded||
counit_signal = ||affordances - affordances_reencoded||
```

つまり：
```
ε = ||F(shape) - F(G(F(shape)))||
```

## 3. εの意味論的解釈

### 3.1 「アクションの曖昧性」

**Unit η**: 「形状がアフォーダンスで捉えきれない部分」  
**Counit ε**: 「アフォーダンスが形状で一意に決まらない部分」

#### 具体例

**η（形状の余白）**:
- 形状: 「赤いリンゴ」
- F(形状): 「掴める、食べられる」（アフォーダンス）
- G(F(形状)): 「掴めて食べられる何か」（再構成）
- η = ||「赤いリンゴ」 - 「掴めて食べられる何か」||
- **解釈**: 「赤い」という情報が失われている

**ε（アクションの曖昧性）**:
- アフォーダンス: 「掴める、食べられる」
- G(アフォーダンス): 「リンゴのような形状」（再構成）
- F(G(アフォーダンス)): 「掴める、食べられる、投げられる」（再エンコード）
- ε = ||「掴める、食べられる」 - 「掴める、食べられる、投げられる」||
- **解釈**: 「投げられる」という新しいアフォーダンスが現れた

### 3.2 「往復での情報の変化」

| 往復 | 開始 | 終了 | 測定 |
|:---|:---|:---|:---|
| **Shape → Aff → Shape** | Shape | G(F(Shape)) | η = 形状の余白 |
| **Aff → Shape → Aff** | Affordance | F(G(Affordance)) | ε = アクションの曖昧性 |

**η ≠ 0**: 形状の一部の情報がアフォーダンスで表現できない  
**ε ≠ 0**: アフォーダンスから形状を経由すると、新しいアフォーダンスが現れる

### 3.3 「多対多の関係」

**ε が大きい場合**:
- 1つのアフォーダンスに対して、複数の形状が対応する
- 形状を経由すると、元のアフォーダンスと異なるアフォーダンスが得られる

**例**:
- アフォーダンス: 「座れる」
- 対応する形状: 「椅子」「ソファ」「床」「階段」...
- F(「椅子」): 「座れる、持ち上げられる」
- F(「ソファ」): 「座れる、寝られる」
- F(「床」): 「座れる、歩ける」

**ε**: これらの違いを測定する

## 4. εとηの対称性と非対称性

### 4.1 対称性

| 側面 | η | ε |
|:---|:---|:---|
| **圏論的役割** | Unit | Counit |
| **往復** | Shape → Aff → Shape | Aff → Shape → Aff |
| **測定** | 情報の損失 | 情報の増加/変化 |

### 4.2 非対称性

**η（形状の余白）**:
- 形状は「豊か」（高次元）
- アフォーダンスは「抽象的」（低次元）
- η は「圧縮による損失」

**ε（アクションの曖昧性）**:
- アフォーダンスは「抽象的」（低次元）
- 形状は「具体的」（高次元）
- ε は「具体化による多様性」

## 5. 保留構造との関係

### 5.1 ηとεの両方が保留に必要

**η（形状の余白）**:
- 「完全には分からない」状態
- 「確定と未確定の共存」

**ε（アクションの曖昧性）**:
- 「複数の可能性がある」状態
- 「選択肢が絞られていない」

**保留構造**:
- η と ε の両方が非ゼロ → 「余白がある」
- Agent C がこの余白をナビゲート → 「保留」

### 5.2 確信度との関係

**確信度 = 1 - normalized_entropy(priority_distribution)**

- **η が大きい**: 形状の理解が不完全 → Priority分布が広がる → 確信度低い
- **ε が大きい**: アクションの選択肢が多い → Priority分布が広がる → 確信度低い

**Curiosity報酬**:
```
R_curiosity = confidence(t) - confidence(t-1)
            = (η(t-1) + ε(t-1)) - (η(t) + ε(t))  (簡略化)
```

つまり、**Curiosityは「η と ε の縮小」**として定義できる可能性がある。

## 6. Agent Cへの提供方法

### Option A: εをValence更新に使う

```python
# Competence報酬を拡張
R_competence = coherence_signal + counit_signal
# または
R_competence = (coherence_signal + counit_signal) / 2
```

**解釈**: 「形状空間とアフォーダンス空間の両方の破綻に注目する」

### Option B: εを観測として追加

```python
# RSSMの観測入力にεを追加
obs_features = [spatial_features, coherence_signal, counit_signal]
```

**解釈**: 「Agent Cがεを直接観測し、それに基づいて行動を調整する」

### Option C: εをPriority計算に使う

```python
# Priority計算を拡張
priority = coherence × uncertainty × valence × (1 + counit_signal)
```

**解釈**: 「アクションの曖昧性が高いほど、注目すべき」

## 7. 期待される効果

### 7.1 εを無視した場合（現状）

- η のみを観測 → 「形状の余白」のみに注目
- アクションの曖昧性を見逃す可能性

### 7.2 εを追加した場合

- η と ε の両方を観測 → 「形状とアクションの両方の余白」に注目
- より豊かな保留構造が創発する可能性

### 7.3 具体的なシナリオ

**シナリオ1: η大、ε小**
- 形状は複雑だが、アクションは明確
- 例: 「複雑な形状だが、明らかに掴める」
- Agent Cの行動: 形状の理解に集中

**シナリオ2: η小、ε大**
- 形状は単純だが、アクションが曖昧
- 例: 「シンプルな形状だが、座れるのか、乗れるのか不明」
- Agent Cの行動: アクションの選択に集中

**シナリオ3: η大、ε大**
- 形状もアクションも不明確
- 例: 「見たことのない物体」
- Agent Cの行動: 探索的に振る舞う（保留構造の典型）

**シナリオ4: η小、ε小**
- 形状もアクションも明確
- 例: 「よく知っている物体」
- Agent Cの行動: 確信を持って行動

## 8. 推奨する実装

### Phase 1: εの観測

まず、εを計算して記録し、その値を観察する：
- εの典型的な値の範囲は？
- ηとεの相関は？
- εは訓練中に変化するか？

### Phase 2: εをAgent Cに提供

観察結果に基づいて、最適な提供方法を選択：
- Option A（Valence）: εが「破綻」として解釈できる場合
- Option B（観測）: εが独立した情報を持つ場合
- Option C（Priority）: εが「注目すべき度合い」を表す場合

### Phase 3: 保留構造の観察

η と ε の両方を使った訓練で、保留構造が創発するか観察：
- 確信度が動的に変化するか？
- η と ε が非ゼロのまま保持されるか？
- Agent Cが「余白をナビゲート」する振る舞いを示すか？

## 9. まとめ

| 項目 | 内容 |
|:---|:---|
| **圏論的定義** | ε: F(G(Affordance)) → Affordance |
| **計算** | ε = \\|F(shape) - F(G(F(shape)))\\| |
| **意味** | アクションの曖昧性、選択肢の多様性 |
| **ηとの関係** | η = 形状の余白、ε = アクションの余白 |
| **保留との関係** | η と ε が非ゼロ → 余白がある → 保留構造 |
| **確信度との関係** | ε大 → Priority分布が広がる → 確信度低い |
| **Curiosityとの関係** | Curiosity = ε の縮小（可能性） |
| **推奨** | まずεを観測し、その後Agent Cに提供する方法を決定 |

**次のステップ**: εを計算・記録し、実験で観察する。
