# Phase 1実験結果レポート

**実験日時**: 2026-02-18 10:00  
**実験時間**: 約2分  
**エポック数**: 50

## 実験概要

Phase 1では、Functor FとFunctor Gの事前訓練を行いました。Agent Cは凍結され、F/Gのみが訓練されます。目的は、F/Gが基本的な形状-アフォーダンスマッピングを学習し、後続のPhaseでAgent Cの「目」として機能することです。

## 訓練設定

- **バッチサイズ**: 4
- **訓練サンプル数**: 100
- **検証サンプル数**: 20
- **学習率**: 1e-3
- **損失関数**:
  - 再構成損失（λ=1.0）
  - アフォーダンス予測損失（λ=1.0）
  - コヒーレンス正則化（λ=0.1）

## 主要結果

### η（再構成誤差）の改善

| データセット | 初期η | 最終η | 削減率 |
|------------|------|------|-------|
| 訓練データ | 0.1593 | 0.1003 | **37.0%** |
| 検証データ | 0.6213 | 0.1284 | **79.3%** |

### 学習曲線の特徴

- **訓練データ**: 安定した減少傾向。η=0.10付近で収束。
- **検証データ**: 大幅な改善（79.3%削減）。初期の過学習傾向が解消され、汎化性能が向上。

### チェックポイント

以下のチェックポイントが保存されました：

- `phase1_epoch_5.pt`
- `phase1_epoch_10.pt`
- `phase1_epoch_15.pt`
- `phase1_epoch_20.pt`
- `phase1_epoch_25.pt`
- `phase1_epoch_30.pt`
- `phase1_epoch_35.pt`
- `phase1_epoch_40.pt`
- `phase1_epoch_45.pt`
- `phase1_epoch_50.pt`
- `phase1_final.pt`（最終チェックポイント）

## 考察

Phase 1の訓練は成功しました。F/Gは基本的な形状-アフォーダンスマッピングを学習し、再構成誤差（η）を大幅に削減しました。特に検証データでの79.3%の削減は、モデルが訓練データに過適合せず、汎化能力を獲得したことを示しています。

### 次のステップ

Phase 1のチェックポイント（`phase1_final.pt`）を使用して、Phase 2（内発的報酬ベースライン実験）に進みます。Phase 2では、F/Gを固定し、Agent Cが内発的報酬のみで学習できるかを検証します。

## 技術的な改善点

今回の実験では、以下の改善を実装しました：

1. **チェックポイント機能**: 5エポックごとに自動保存。中断されても再開可能。
2. **定期的な進捗出力**: タイムスタンプ付きで10バッチごとに出力。`sys.stdout.flush()`で即座に反映。
3. **自動再開機能**: 最新のチェックポイントを自動検出し、途中から訓練を継続。

これらの改善により、サンドボックスの非アクティブリセットを回避し、実験を最後まで完了できました。
